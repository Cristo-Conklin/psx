<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Routing &mdash; PSX 0.9 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PSX 0.9 documentation" href="index.html" />
    <link rel="up" title="Getting started" href="getting_started.html" />
    <link rel="next" title="Controller" href="controller.html" />
    <link rel="prev" title="Design" href="design.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="controller.html" title="Controller"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="design.html" title="Design"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PSX 0.9 documentation</a> &raquo;</li>
          <li><a href="getting_started.html" accesskey="U">Getting started</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="routing">
<h1>Routing<a class="headerlink" href="#routing" title="Permalink to this headline">¶</a></h1>
<p>Routing is the process to delegate the HTTP request to the fitting controller.
By default PSX uses a simple routing file wich contains all available routes.
The routing file was inspired by the java play framework</p>
<div class="section" id="routing-file">
<h2>Routing file<a class="headerlink" href="#routing-file" title="Permalink to this headline">¶</a></h2>
<p>PSX parses the routing file and the route which matches is taken. Lets see the
following example routing file</p>
<div class="highlight-none"><div class="highlight"><pre># example routing file

GET / Foo\News\Application\Index::doFoo
GET /foo ~/
GET|POST /api Foo\News\Application\Api::doIndex
GET /news/:news_id Foo\News\Application\News::doDetail
GET /news/archive/$year&lt;[0-9]+&gt; Foo\News\Application\News::doArchive
GET /file/*path Foo\News\Application\File::downloadFile
</pre></div>
</div>
<p>in case we make the following HTTP request the class Foo\News\Application\Api
gets created and the doIndex method gets called</p>
<div class="highlight-none"><div class="highlight"><pre>GET /api HTTP/1.1
</pre></div>
</div>
<p>The path /foo is an alias for the path /. That means in both cases we call the
method doFoo of the class Foo\News\Application\Index.</p>
<p>If we make an HTTP request to /news/2 the controller
FooNewsApplicationNews::doDetail gets called. In our controller we can access
the dynmic part of the path with</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="nv">$newsId</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getUriFragment</span><span class="p">(</span><span class="s1">&#39;news_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The dynamic part contains all content to the next slash. You can also specifiy
an regular expression to define which chars are allowed in the dynamic part. In
our example the path /news/archive/$year&lt;[0-9]+&gt; is only matched if the last
part contains numeric signs i.e. /news/archive/2014.</p>
<p>Also you can specifiy an wildcard * which matches all content i.e.
/file/foo/bar/test.txt would invoke FooNewsApplicationFile::downloadFile</p>
</div>
<div class="section" id="reverse-routing">
<h2>Reverse routing<a class="headerlink" href="#reverse-routing" title="Permalink to this headline">¶</a></h2>
<p>PSX contains an reverse router class with that it is possible to get the path or
url to an existing controller method. If you want i.e. to link or redirect to an
specific controller method</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="nv">$path</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getReverseRouter</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getPath</span><span class="p">(</span><span class="s1">&#39;Foo\News\Application\Index::doFoo&#39;</span><span class="p">);</span>
<span class="nv">$url</span>  <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getReverseRouter</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;Foo\News\Application\Index::doFoo&#39;</span><span class="p">);</span>
<span class="nv">$path</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getReverseRouter</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getPath</span><span class="p">(</span><span class="s1">&#39;Foo\News\Application\News::doArchive&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;year&#39;</span> <span class="o">=&gt;</span> <span class="mi">2014</span><span class="p">));</span>
</pre></div>
</div>
<p>or in you template you can use</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$router</span><span class="o">-&gt;</span><span class="na">getPath</span><span class="p">(</span><span class="s1">&#39;Foo\News\Application\Index::doFoo&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;Home&lt;/a&gt;</span>
</pre></div>
</div>
<p>this has the advantage that you can easily change your urls in your routing file
and all links point automatically to the correct path.</p>
</div>
<div class="section" id="custom-routing">
<h2>Custom routing<a class="headerlink" href="#custom-routing" title="Permalink to this headline">¶</a></h2>
<p>If you want to store you routes in another format or in an database you can
easily write your own RoutingParser. The routing parser returns an
RoutingCollection which contains all available routes.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">interface</span> <span class="nx">RoutingParserInterface</span>
<span class="p">{</span>
	<span class="sd">/**</span>
<span class="sd">	 * @return PSX\Loader\RoutingCollection</span>
<span class="sd">	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">getCollection</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Your routing class has to implement this interface. Then you can overwrite the
method getRoutingParser() in your DI container.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Routing</a><ul>
<li><a class="reference internal" href="#routing-file">Routing file</a></li>
<li><a class="reference internal" href="#reverse-routing">Reverse routing</a></li>
<li><a class="reference internal" href="#custom-routing">Custom routing</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="design.html"
                        title="previous chapter">Design</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="controller.html"
                        title="next chapter">Controller</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/routing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="controller.html" title="Controller"
             >next</a> |</li>
        <li class="right" >
          <a href="design.html" title="Design"
             >previous</a> |</li>
        <li><a href="index.html">PSX 0.9 documentation</a> &raquo;</li>
          <li><a href="getting_started.html" >Getting started</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Christoph Kappestein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>