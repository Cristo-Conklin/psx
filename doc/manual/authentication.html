<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Authentication &mdash; PSX 0.9 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PSX 0.9 documentation" href="index.html" />
    <link rel="up" title="Tutorials" href="tutorials.html" />
    <link rel="prev" title="Building an REST API" href="build_api.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="build_api.html" title="Building an REST API"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PSX 0.9 documentation</a> &raquo;</li>
          <li><a href="tutorials.html" accesskey="U">Tutorials</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="authentication">
<h1>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h1>
<p>It is often the case that you want that only registered users can POST new
entries to the API endpoint. In this case the user has to authorize before
submitting a new record. PSX offers several authorization methods for your API.
In this chapter we will look at different authentication methods and howto
implement them.</p>
<div class="section" id="basic-authentication">
<h2>Basic authentication<a class="headerlink" href="#basic-authentication" title="Permalink to this headline">¶</a></h2>
<p>Basic authentication is the most simple authentication method where a user
provides an username and password in the header. Note if you use basic
authentication you should use https since the username and password is
transported in plaintext over the wire. Add the following method to the
controller in order to add basic authentication</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">use</span> <span class="nx">PSX\Dispatch\RequestFilter\BasicAuthentication</span><span class="p">;</span>

<span class="o">...</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">getPostFilter</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$auth</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BasicAuthentication</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">){</span>

            <span class="k">if</span><span class="p">(</span><span class="nv">$username</span> <span class="o">==</span> <span class="s1">&#39;[username]&#39;</span> <span class="o">&amp;&amp;</span> <span class="nv">$password</span> <span class="o">==</span> <span class="s1">&#39;[passsword]&#39;</span><span class="p">)</span>
            <span class="p">{</span>
                    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

    <span class="p">});</span>

    <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="nv">$auth</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="oauth-authentication">
<h2>Oauth authentication<a class="headerlink" href="#oauth-authentication" title="Permalink to this headline">¶</a></h2>
<p>Sample oauth authentication. This is only to illustrate what to return. Normally
you have to check</p>
<ul class="simple">
<li>is the consumerKey valid</li>
<li>does the token belongs to an valid request with a valid status</li>
<li>is the token not expired</li>
</ul>
<p>PSX calculates and compares the signature if you return an consumer. For more
informations see <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc5849.html#anchor"><strong>RFC 5849</strong></a></p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">use</span> <span class="nx">PSX\Dispatch\RequestFilter\OauthAuthentication</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">PSX\Oauth\Provider\Data\Consumer</span><span class="p">;</span>

<span class="o">...</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">getPostFilter</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$auth</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OauthAuthentication</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$consumerKey</span><span class="p">,</span> <span class="nv">$token</span><span class="p">){</span>

            <span class="k">if</span><span class="p">(</span><span class="nv">$consumerKey</span> <span class="o">==</span> <span class="s1">&#39;[consumerKey]&#39;</span> <span class="o">&amp;&amp;</span> <span class="nv">$token</span> <span class="o">==</span> <span class="s1">&#39;[token]&#39;</span><span class="p">)</span>
            <span class="p">{</span>
                    <span class="k">return</span> <span class="k">new</span> <span class="nx">Consumer</span><span class="p">(</span><span class="s1">&#39;[consumerKey]&#39;</span><span class="p">,</span> <span class="s1">&#39;[consumerSecret]&#39;</span><span class="p">,</span> <span class="s1">&#39;[token]&#39;</span><span class="p">,</span> <span class="s1">&#39;[tokenSecret]&#39;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

    <span class="p">});</span>

    <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="nv">$auth</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Authentication</a><ul>
<li><a class="reference internal" href="#basic-authentication">Basic authentication</a></li>
<li><a class="reference internal" href="#oauth-authentication">Oauth authentication</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="build_api.html"
                        title="previous chapter">Building an REST API</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/authentication.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="build_api.html" title="Building an REST API"
             >previous</a> |</li>
        <li><a href="index.html">PSX 0.9 documentation</a> &raquo;</li>
          <li><a href="tutorials.html" >Tutorials</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Christoph Kappestein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>